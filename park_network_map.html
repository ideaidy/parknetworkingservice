<!DOCTYPE html>
<html>
<head>
    <title>ê³µì› ë„¤íŠ¸ì›Œí‚¹ ì„œë¹„ìŠ¤ ë¶„ì„ ê²°ê³¼</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/SJPdeE109F+79A/SjY="
          crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20n6aR4v98Lz0I+cO72uS65uHnJ2Q6B6U0lS515+N80="
            crossorigin=""></script>
    <style>
        #map { height: 600px; width: 100%; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        body { font-family: 'Malgun Gothic', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #f8f8f8; }
        h1 { color: #2c3e50; text-align: center; margin-bottom: 5px; }
        h2 { color: #e74c3c; font-size: 1.2em; text-align: center; margin-top: 5px; margin-bottom: 20px;}
        .legend { background: white; padding: 10px; border-radius: 5px; box-shadow: 0 1px 5px rgba(0,0,0,0.4); }
    </style>
</head>
<body>

<h1>ğŸŒ³ ì„œìš¸ ê°•ë‚¨êµ¬ ê³µì› ë„¤íŠ¸ì›Œí‚¹ ë¶„ì„ ê²°ê³¼</h1>
<h2>(ë‹¨ì ˆ ê¸°ì¤€: 0.8km)</h2>

<div id="map"></div>

<script>
    // 1. ë°ì´í„° ì •ì˜ (Python ë¶„ì„ ê²°ê³¼)
    const allParks = JSON.parse('{"ê³µì›ëª…": "ì‹ ì‚¬ê·¼ë¦°ê³µì›", "ìœ„ë„": 37.526708, "ê²½ë„": 127.0212651}...'); // ì „ì²´ ê³µì› ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ì‚½ì…
    const disconnectionSegments = JSON.parse('[{"parkA_name": "ë…¼í˜„ê³µì›", "parkA_coords": [37.51473, 127.03923], "parkB_name": "ì‹ ì‚¬ê·¼ë¦°ê³µì›", "parkB_coords": [37.52671, 127.02127], "distance_km": 1.05, "midpoint_coords": [37.52072, 127.03025]}, {"parkA_name": "ëŠ¥ì•ˆê³µì›", "parkA_coords": [37.49133, 127.08643], "parkB_name": "í¬ì´ê·¼ë¦°ê³µì›", "parkB_coords": [37.4811, 127.04278], "distance_km": 1.157, "midpoint_coords": [37.48622, 127.06461]}, {"parkA_name": "ëª½ë§ˆë¥´ëœ¨ê³µì›", "parkA_coords": [37.49883, 127.00947], "parkB_name": "ì„œì´ˆì—­ê³µì›", "parkB_coords": [37.49219, 127.01202], "distance_km": 1.171, "midpoint_coords": [37.49551, 127.01074]}, {"parkA_name": "ì‚¼ì„±2ë™ ê³µì›", "parkA_coords": [37.51187, 127.05432], "parkB_name": "ëŠ¥ì•ˆê³µì›", "parkB_coords": [37.49133, 127.08643], "distance_km": 0.963, "midpoint_coords": [37.5016, 127.07037]}, {"parkA_name": "ì˜ë™ëŒ€ë¡œê³µì›", "parkA_coords": [37.50974, 127.06326], "parkB_name": "ë´‰ì€ê·¼ë¦°ê³µì›", "parkB_coords": [37.51448, 127.05193], "distance_km": 1.139, "midpoint_coords": [37.51211, 127.0576]}, {"parkA_name": "ì••êµ¬ì •ë™ ê³µì›", "parkA_coords": [37.5276, 127.03157], "parkB_name": "ì‹ ì‚¬ê·¼ë¦°ê³µì›", "parkB_coords": [37.52671, 127.02127], "distance_km": 1.487, "midpoint_coords": [37.52715, 127.02642]}, {"parkA_name": "ì½”ìŠ¤ëª¨ìŠ¤ ì–´ë¦°ì´ê³µì›", "parkA_coords": [37.49261, 127.08779], "parkB_name": "ëŠ¥ì•ˆê³µì›", "parkB_coords": [37.49133, 127.08643], "distance_km": 0.97, "midpoint_coords": [37.49197, 127.08711]}, {"parkA_name": "í¬ì´ê·¼ë¦°ê³µì›", "parkA_coords": [37.4811, 127.04278], "parkB_name": "ëŠ¥ì•ˆê³µì›", "parkB_coords": [37.49133, 127.08643], "distance_km": 1.157, "midpoint_coords": [37.48622, 127.06461]}, {"parkA_name": "í•œê°•ê³µì›", "parkA_coords": [37.52989, 127.01358], "parkB_name": "ë´‰ì€ê·¼ë¦°ê³µì›", "parkB_coords": [37.51448, 127.05193], "distance_km": 1.701, "midpoint_coords": [37.52219, 127.03276]}, {"parkA_name": "í•´ì°¬ì†”ê·¼ë¦°ê³µì›", "parkA_coords": [37.47039, 127.0924], "parkB_name": "ì•ˆê°œê·¼ë¦°ê³µì›", "parkB_coords": [37.47218, 127.10195], "distance_km": 0.999, "midpoint_coords": [37.47128, 127.09717]}]'.replace('...', ''))

    // 2. ì§€ë„ ì´ˆê¸°í™” (ê°•ë‚¨êµ¬ ì¤‘ì‹¬ ì¢Œí‘œ: ëŒ€ëµ 37.50, 127.04)
    const map = L.map('map').setView([37.50, 127.04], 13);

    // ê¸°ë³¸ íƒ€ì¼ ë ˆì´ì–´ ì¶”ê°€ (OpenStreetMap)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    // 3. ë§ˆì»¤ ë° ë¼ì¸ ìŠ¤íƒ€ì¼ ì •ì˜
    const ParkIcon = L.divIcon({className: 'park-icon', html: '<div style="background-color:#2ecc71; width:10px; height:10px; border-radius:50%; border: 1px solid white;"></div>', iconSize: [12, 12]});
    const DisconnectIcon = L.divIcon({className: 'disconnect-icon', html: '<div style="background-color:#e74c3c; width:12px; height:12px; border-radius:50%; border: 2px solid white;"></div>', iconSize: [16, 16]});
    const RecommendIcon = L.divIcon({className: 'recommend-icon', html: '<div style="background-color:#3498db; width:14px; height:14px; border-radius:50%; border: 2px solid white; animation: pulse 1s infinite alternate;"></div>', iconSize: [20, 20]});

    // 4. ì „ì²´ ê³µì› ë§ˆì»¤ ì¶”ê°€ (ë‹¨ì ˆ êµ¬ê°„ì— ì†í•˜ì§€ ì•ŠëŠ” ê³µì› í¬í•¨)
    const parkLocations = new Set();
    allParks.forEach(park => {
        // ì¤‘ë³µ ë§ˆì»¤ ë°©ì§€ë¥¼ ìœ„í•´ ì¢Œí‘œë¥¼ keyë¡œ ì €ì¥
        parkLocations.add(`${park.ìœ„ë„},${park.ê²½ë„}`); 
        L.marker([park.ìœ„ë„, park.ê²½ë„], {icon: ParkIcon})
            .bindPopup(`<b>${park.ê³µì›ëª…}</b><br>ì¼ë°˜ ê³µì›`)
            .addTo(map);
    });

    // 5. ë‹¨ì ˆ êµ¬ê°„ ë° ì¶”ì²œ ë¶€ì§€ ì‹œê°í™”
    const disconnectionLayer = L.layerGroup().addTo(map);

    disconnectionSegments.forEach(segment => {
        // ë‹¨ì ˆ êµ¬ê°„ì„ ë‚˜íƒ€ë‚´ëŠ” ë¼ì¸ (ë¹¨ê°„ìƒ‰)
        L.polyline([segment.parkA_coords, segment.parkB_coords], {color: '#e74c3c', weight: 4, dashArray: '10, 10'})
            .bindPopup(`<b>ë‹¨ì ˆ êµ¬ê°„ (ìœ„í—˜)</b><br>ê±°ë¦¬: ${segment.distance_km} km (0.8km ì´ˆê³¼)`)
            .addTo(disconnectionLayer);

        // ì‹ ì„¤ ê³µì› ì¶”ì²œ ë¶€ì§€ (ì¤‘ê°„ ì§€ì , íŒŒë€ìƒ‰ ì )
        L.marker(segment.midpoint_coords, {icon: RecommendIcon})
            .bindPopup(`<b>ì‹ ì„¤ ê³µì› ì¶”ì²œ ë¶€ì§€</b><br>A: ${segment.parkA_name}<br>B: ${segment.parkB_name} <br>ì´ ê³µì›ë“¤ ì‚¬ì´ì˜ ê³µë°±ì„ ì±„ì›ë‹ˆë‹¤.`)
            .addTo(disconnectionLayer);
        
        // ë‹¨ì ˆ êµ¬ê°„ì— ì†í•˜ëŠ” ê³µì› A (ë¹¨ê°„ìƒ‰ ë§ˆì»¤)
        L.marker(segment.parkA_coords, {icon: DisconnectIcon})
            .bindPopup(`<b>ë‹¨ì ˆ ìœ„í—˜ ê³µì›: ${segment.parkA_name}</b><br>ê°€ì¥ ê°€ê¹Œìš´ ê³µì› (${segment.parkB_name})ê¹Œì§€ ê±°ë¦¬: ${segment.distance_km} km`)
            .addTo(disconnectionLayer);
            
        // ë‹¨ì ˆ êµ¬ê°„ì— ì†í•˜ëŠ” ê³µì› B (ë¹¨ê°„ìƒ‰ ë§ˆì»¤)
        L.marker(segment.parkB_coords, {icon: DisconnectIcon})
            .bindPopup(`<b>ë‹¨ì ˆ ìœ„í—˜ ê³µì›: ${segment.parkB_name}</b><br>ê°€ì¥ ê°€ê¹Œìš´ ê³µì› (${segment.parkA_name})ê¹Œì§€ ê±°ë¦¬: ${segment.distance_km} km`)
            .addTo(disconnectionLayer);
    });

    // 6. ë²”ë¡€ ì¶”ê°€ (Optional: ë°œí‘œ í€„ë¦¬í‹° í–¥ìƒ)
    const legend = L.control({position: 'bottomright'});

    legend.onAdd = function (map) {
        const div = L.DomUtil.create('div', 'legend');
        div.innerHTML = `
            <h4>ì§€ë„ ë²”ë¡€</h4>
            <div><span style="background:#2ecc71; width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:5px;"></span> ì¼ë°˜ ê³µì›</div>
            <div><span style="background:#e74c3c; width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:5px; border: 2px solid white;"></span> ë‹¨ì ˆ ìœ„í—˜ ê³µì›</div>
            <div><span style="border-top: 4px dashed #e74c3c; width:15px; display:inline-block; margin-right:5px;"></span> ë‹¨ì ˆ êµ¬ê°„ (0.8km ì´ˆê³¼)</div>
            <div><span style="background:#3498db; width:10px; height:10px; border-radius:50%; display:inline-block; margin-right:5px; border: 2px solid white;"></span> ì‹ ì„¤ ê³µì› ì¶”ì²œ ë¶€ì§€</div>
        `;
        return div;
    };
    legend.addTo(map);

    // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
    const style = document.createElement('style');
    style.textContent = `
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.3); }
        }
    `;
    document.head.append(style);

</script>
</body>
</html>
